#include <math.h>
#include "URN.h"

/*------------------------------------------------------------------*\
|   Linear congruential method                                       |
|   This algorithm calculates independent                            |
|   uniformly distributed variables.                                 |
|                                                                    |
|   References:                                                      |
|   1. Dudewicz,E.J. and Ralley,T.: "The Handbook of Random Number   |
|      Generation and Testing," American Sciences Press, Columbus,   |
|      Ohio, 1981, p.71, 86, 134, 142, 620.                          |
|   2. Ahrens, J. H. and Dieter, U.: "Non-Uniform Random-Numbers",   |
|      Inst. f. Math. Statistik, Technische Hochschule Graz (1974).  |
|                                                                    |
|   These are the first 100 numbers from urn                         |
|       Starting value (seed) irn = 524287                           |
|                                                                    |
|   0.79629719    0.84357870    0.04583855    0.14499289             |
|   0.21417092    0.46331453    0.83064634    0.65813643             |
|   0.52331358    0.91584021    0.29460630    0.20976351             |
|   0.38656980    0.67632115    0.51638800    0.26010880             |
|   0.21219136    0.44585952    0.64709449    0.70371789             |
|   0.50613207    0.17664097    0.77622902    0.88482803             |
|   0.67356133    0.06192477    0.96563065    0.92134297             |
|   0.45709682    0.92837775    0.13887870    0.27490112             |
|   0.19925541    0.46825200    0.51366550    0.50453782             |
|   0.11662324    0.74890661    0.26463833    0.14144112             |
|   0.77324426    0.43717247    0.10421009    0.62230128             |
|   0.94072789    0.17606172    0.46883839    0.21875437             |
|   0.03257476    0.55132014    0.99827373    0.90041912             |
|   0.30022216    0.08532377    0.99527615    0.06902803             |
|   0.97830731    0.69581920    0.55330110    0.10115176             |
|   0.56664997    0.05700738    0.03965328    0.63701767             |
|   0.43645361    0.30047157    0.62161005    0.55292177             |
|   0.94822520    0.49344867    0.52301311    0.55473471             |
|   0.26891398    0.33194450    0.69882900    0.33000129             |
|   0.07576896    0.48619276    0.61517835    0.19613390             |
|   0.33441493    0.03595783    0.82233423    0.18219958             |
|   0.33864745    0.43318123    0.00818853    0.48180088             |
|   0.19944660    0.42947173    0.21968779    0.21455052             |
|   0.97070926    0.40593961    0.93973738    0.43363968             |
|   0.59920037    0.54287410    0.70707464    0.31700012             |
|                                                                    |
|                                       Uwe Simmer 21. Nov. 1989     |
\*------------------------------------------------------------------*/

static unsigned int ia, ir;

void urn_init(void)
{
    ir    = 524287;
    ia    = 663608941;
}

int32_t urn(void)
{
    // Linear congruential method

    return ir *= ia;
}

/*------------------------------------------------------------------*\
|   Polarmethod                                                      |
|                                                                    |
|   This algorithm calculates independent                            |
|   normally distributed variables X.                                |
|                                                                    |
|   Reference:                                                       |
|   Knuth, D.E.: The art of computer programming, vol. 2             |
|   Addison-Wesley Publishing Company, Inc., Reading,                |
|   Mass., 1981, Second Edition, p. 117.                             |
|                                                                    |
|                                       Uwe Simmer 21. Nov. 1989     |
\*------------------------------------------------------------------*/
